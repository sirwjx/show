window.__require=function t(e,s,i){function o(n,c){if(!s[n]){if(!e[n]){var r=n.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+n+"'")}n=r}var h=s[n]={exports:{}};e[n][0].call(h.exports,function(t){return o(e[n][1][t]||t)},h,h.exports,t,e,s,i)}return s[n].exports}for(var a="function"==typeof __require&&__require,n=0;n<i.length;n++)o(i[n]);return o}({els_blockGroup:[function(t,e){"use strict";cc._RF.push(e,"1754bi77MVAZJATafmKuAIC","els_blockGroup"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.blockLists=this.getComponentsInChildren("els_blockgrid"),this.curBlockGroup=null,this._iscanmove=!0},start:function(){this.addTouchEvent()},checkIfCanTouch:function(){return!!this._iscanmove},setBlockInfo:function(t){this._scale=t.scale||1,this.node.scale=this._scale,this._frame=t.sp,this._prefabId=t.prefabid,this._colorid=t.colorid,this.blockLists&&this.blockLists.forEach(function(e){e.updateBlock(t.sp)}),this.gamelogic=null,this.soundM=null,this._teachsetp=3,g_wanxArder.game_layer&&(this.gamelogic=g_wanxArder.game_layer.gamelogic,this.soundM=g_wanxArder.game_layer.soundM,this._teachsetp=g_wanxArder.game_layer._teachingStep)},addTouchEvent:function(){this.node.on("touchstart",this.touchStart,this),this.node.on("touchmove",this.touchMove,this),this.node.on("touchend",this.touchEnd,this),this.node.on("touchcancel",this.touchCancel,this)},onDestroy:function(){this.node.off("touchstart",this.touchStart,this),this.node.off("touchmove",this.touchMove,this),this.node.off("touchend",this.touchEnd,this),this.node.off("touchcancel",this.touchCancel,this)},touchStart:function(t){if(this.soundM&&this.soundM.playTouchBlockStart(),this.checkIfCanTouch()&&!(this._teachsetp<3&&this.gamelogic&&this.gamelogic.getIsPlayAnim())){if(g_elsfk.hasTouch)return!1;g_elsfk.hasTouch=!0;var e=t.getLocation(),s=e.x,i=e.y;this.initMoveData({x:s,y:i}),this._teachsetp<3&&g_oEvent.dispatchEvent(g_tEvent.ELS_TEACH_FINGER,!1)}},initMoveData:function(t){var e=t.x,s=t.y;this.blockBeginePos=this.node.getPosition();var i=this.node.parent.convertToNodeSpaceAR(cc.v2(e,s));this.node.scale=1;var o=1e3;this.blockLists&&this.blockLists.forEach(function(t){t.setCurScale(.9);var e=t.getBlockPosition();o=o>e.y?e.y:o}),this.fingerHeight=210-o,i.y+=this.fingerHeight,this.node.y=i.y,this.maplists=g_wanxArder.game_layer.mapBlocks,this.movelists1=[],this.linelists1=[],this.needchecklink=!0},touchMove:function(t){if(this.checkIfCanTouch()&&this.blockBeginePos){var e=t.getDelta();e.x>-1&&e.x<1&&e.y>-1&&e.y<1||(this.node.position=this.node.position.add(e),this.checkGridTips(this.node.position),this.needchecklink&&this.checkIsInLink())}},touchEnd:function(t){this.touchFinish(t)},touchCancel:function(t){this.touchFinish(t)},touchFinish:function(){if(this.checkIfCanTouch()&&this.blockBeginePos){g_elsfk.hasTouch=!1;var t=this.node.position;if(this.movelists1&&this.movelists1.length>0){for(var e=0;e<this.movelists1.length;e++){var s=this.movelists1[e];this.doPlaceAction(s.r,s.c)}var i=this.movelists1.length,o=this.linelists1.length;o>0&&(i+=this.gamelogic.getDeleteScore(o));var a=g_els_localData.getHistoryScore();g_els_localData.saveGameData(i,this.movelists1,this._colorid),this.node&&this.node.destroy();var n=this.getdeleteBlockGroup(),c=!1;n&&n.length>0&&(this._teachsetp>2&&this.gamelogic.checkHasRedpack(o),g_oEvent.dispatchEvent(g_tEvent.ELS_DELETE_MAPBLOCK,n,this._colorid),c=!0);var r={x:t.x,y:t.y+100};g_oEvent.dispatchEvent(g_tEvent.ELS_UPDATE_SCORE,i,a,r),this.placeBack&&this.placeBack(this._prefabId,c),this.soundM&&this.soundM.playTouchBlockEnd()}else this.blockLists&&this.blockLists.forEach(function(t){t.setCurScale(1)}),this.node.setPosition(this.blockBeginePos),this.node.scale=this._scale,this._teachsetp<3&&g_oEvent.dispatchEvent(g_tEvent.ELS_TEACH_FINGER,!0);this.blockBeginePos=null,this.movelists1=[],this.linelists1=[],this.needchecklink=!0}},getCoverGridRC:function(t){var e=!1,s=[];if(this.blockLists&&this.gamelogic)for(var i in this.blockLists)if(this.blockLists.hasOwnProperty(i)){var o=this.blockLists[i].getBlockPosition();o.x+=t.x,o.y+=t.y;var a=this.gamelogic.getGridRC(o);if(a&&this.maplists&&this.maplists[a.r]&&this.maplists[a.r][a.c]&&255==this.maplists[a.r][a.c].getBlockOpacity()&&(a=null),!a){e=!0;break}s.push(a)}return e?[]:s},checkGridTips:function(t){var e=this.movelists1.length-1,s=this.getCoverGridRC(t);if(this._teachsetp<3){for(var i=s.slice(0,s.length),o=g_els_localData.getTeachFillGrid(this._teachsetp),a=0;a<o.length;a++)for(var n=o[a],c=i.length-1;c>=0;c--){var r=i[c];if(r.r==n.r&&r.c==n.c){i.splice(c,1);break}}i.length>0&&s.splice(0)}var l=s.length<=0;for(a=e;a>=0;a--){var h=!1,u=this.movelists1[a];for(c=s.length-1;c>=0;c--)if(u.r==s[c].r&&u.c==s[c].c){h=!0,s.splice(c,1);break}h||(this.movelists1.splice(a,1),this.changeMapBlock(u.r,u.c,0,!1))}for(a=0;a<s.length;a++)n=s[a],this.changeMapBlock(n.r,n.c,100,!0),this.movelists1.push(n);!l&&s.length<=0?this.needchecklink=!1:this.needchecklink=!0},changeMapBlock:function(t,e,s,i){if(this.maplists&&this.maplists[t]&&this.maplists[t][e]){var o=this.maplists[t][e];o.setBlockOpacity(s),i&&o.changeSpriteframe(this._frame)}},doPlaceAction:function(t,e){if(this.maplists&&this.maplists[t]&&this.maplists[t][e]){var s=this.maplists[t][e];s.doPlaceAction(),s.setPreSpframe(this._frame)}},checkIsInLink:function(){var t=this,e=[],s=[],i=!0,o=function(t,s){for(var i=!1,o=0;o<e.length;o++){var a=e[o];if(a&&""!=a){var n=a.split("_");if(n[0]==s&&n[1]==t){i=!0;break}}}return i},a=function(e,o){return t.maplists&&t.maplists[e]&&t.maplists[e][o]&&(0!==t.maplists[e][o].getBlockOpacity()?s.push({r:r,c:c.c}):i=!1),i};if(this.maplists&&this.movelists1)for(var n=0;n<this.movelists1.length;n++){var c=this.movelists1[n];if(!o(c.c,"col")){s=[],i=!0;for(var r=c.r-1;r>=0&&a(r,c.c);r--);if(i)for(r=c.r+1;r<g_els_localData.maxRow&&a(r,c.c);r++);s.length==g_els_localData.maxRow-1&&e.push("col_"+c.c)}if(!o(c.r,"row")){for(s=[],i=!0,r=c.c-1;r>=0&&a(c.r,r);r--);if(i)for(r=c.c+1;r<g_els_localData.maxCol&&a(c.r,r);r++);s.length==g_els_localData.maxCol-1&&e.push("row_"+c.r)}}for(n=this.linelists1.length-1;n>=0;n--){for(var l=!1,h=0;h<e.length;h++)if(e[h]==this.linelists1[n]){l=!0,e.splice(h,1);break}if(!l){var u=this.linelists1[n];this.linelists1.splice(n,1),this.changeMapBlockInLine(u,!0)}}for(n=0;n<e.length;n++)u=e[n],this.changeMapBlockInLine(u,!1),this.linelists1.push(u)},changeMapBlockInLine:function(t,e){if(t&&""!==t){var s=t.split("_");if("row"==s[0]){for(var i=parseInt(s[1]),o=0;o<g_els_localData.maxCol;o++)if(this.maplists&&this.maplists[i]&&this.maplists[i][o]){var a=this.maplists[i][o];e?a.changeToPreFrame():a.changeSpriteframe(this._frame)}}else if("col"==s[0]){var n=parseInt(s[1]);for(o=0;o<g_els_localData.maxRow;o++)this.maplists&&this.maplists[o]&&this.maplists[o][n]&&(a=this.maplists[o][n],e?a.changeToPreFrame():a.changeSpriteframe(this._frame))}}},checkHasPlaceToPut:function(){this.maplists=g_wanxArder.game_layer.mapBlocks;for(var t=!1,e=0;e<g_els_localData.maxRow;e++){for(var s=0;s<g_els_localData.maxCol;s++){var i=this.gamelogic.getGridPosition(e,s);if(this.getCoverGridRC(i).length>0){t=!0;break}}if(t)break}var o=t?0:1;return this._iscanmove=t,this.blockLists&&this.blockLists.forEach(function(t){t.setblockGray(o)}),t},getdeleteBlockGroup:function(){var t=[];if(!this.movelists1||this.movelists1.length<=0||!this.linelists1||this.linelists1.length<=0)return t;for(var e=0;e<this.linelists1.length;e++){var s=0,i=this.linelists1[e];if(i&&""!=i){var o=i.split("_"),a=g_els_localData.maxRow,n=-1,c=parseInt(o[1]);if("row"==o[0]){for(var r=0;r<this.movelists1.length;r++)c==(h=this.movelists1[r]).r&&(h.c>n?n=h.c:h.c<a&&(a=h.c),t[s]=t[s]||[],t[s].push(h));s=1;for(var l=(a=a>n?n:a)-1;l>=0;l--)t[s]=t[s]||[],t[s].push({r:c,c:l}),s++;for(s=1,l=n+1;l<g_els_localData.maxCol;l++)t[s]=t[s]||[],t[s].push({r:c,c:l}),s++}else if("col"==o[0]){for(r=0;r<this.movelists1.length;r++){var h;c==(h=this.movelists1[r]).c&&(h.r>n?n=h.r:h.r<a&&(a=h.r),t[s]=t[s]||[],t[s].push(h))}for(s=1,l=(a=a>n?n:a)-1;l>=0;l--)t[s]=t[s]||[],t[s].push({r:l,c:c}),s++;for(s=1,l=n+1;l<g_els_localData.maxRow;l++)t[s]=t[s]||[],t[s].push({r:l,c:c}),s++}}}return t}}),cc._RF.pop()},{}],els_blockgrid:[function(t,e){"use strict";cc._RF.push(e,"26621NAfVJN8J05/iPZcauA","els_blockgrid"),cc.Class({extends:cc.Component,properties:{},updateBlock:function(t){g_wanxArder.nodeIsValid(this.node)&&(this.node.getComponent("cc.Sprite").spriteFrame=t)},setCurScale:function(t){this.node.scale=t},getBlockPosition:function(){return this.node.getPosition()},changeNodeParent:function(){if(g_wanxArder.game_layer){var t=g_wanxArder.game_layer.touch_board;this.node.parent=t}},setblockGray:function(t){g_wanxArder.nodeIsValid(this.node)&&this.node.getComponent("cc.Sprite").setState(t)}}),cc._RF.pop()},{}],els_gameLayer:[function(t,e){"use strict";cc._RF.push(e,"dbd7bJgLXVKBrVZX2zKrpsu","els_gameLayer");var s=["els_block_lizi_shenlan","els_block_lizi_blue","els_block_lizi_fen","els_block_lizi_purple","els_block_lizi_yellow","els_block_lizi_green","els_block_lizi_red"],i=["els_shenlan","els_blue","els_fen","els_purple","els_yellow","els_green","els_red"];cc.Class({extends:cc.Component,properties:{lab_histroy:cc.Label,lab_curtotal:cc.Label,map_board:cc.Node,touch_board:cc.Node,blockAnimNode:cc.Node,frame_block:[cc.SpriteFrame],chuiziCount:cc.Label,chongzhiCount:cc.Label,refreshImg:cc.Node,els_scorePre:cc.Prefab,els_boomItem:cc.Node,teachParent:cc.Node,propNode:cc.Node,topnode:cc.Node,panel:cc.Node},onLoad:function(){window.g_els_localData=t("els_localData"),window.g_elsfk={},g_elsfk.hasTouch=!1,g_wxPlat.showBannerAd(2),Tips.changeScene(),g_arder_plat._init(),g_wanxArder.game_layer=this,this.init(),this.blockAnimPre=[],this.blockLzPre=[],this.teachParent.zIndex=9,this.touch_board.zIndex=10,this.els_boomItem.zIndex=10,this.listenBoom(),this.propNode&&(this.propNode.active=!1),this.topnode&&(this.topnode.active=!1)},start:function(){this.touch_board.removeAllChildren(),this.map_board.removeAllChildren(),this.showSettingView(!1),this.onMassegeEvent(),this.updatePropCount(),this._propLimit=g_arder_gmsc.getElsPropShowLimit()},onDestroy:function(){g_oEvent.clearEventListener(g_tEvent.ELS_PROPGET_BOX,this.showPropBox,this),g_oEvent.clearEventListener(g_tEvent.ELS_DELETE_MAPBLOCK,this.deleteMapBlocks,this),g_oEvent.clearEventListener(g_tEvent.ELS_PROP_USED,this.propUsed,this),g_oEvent.clearEventListener(g_tEvent.ELS_UPDATE_SCORE,this.showAddScore,this),g_oEvent.clearEventListener(g_tEvent.OUT_GAME,this.onShowPause,this),this.blockAnimPre.splice(0),this.blockLzPre.splice(0),g_wanxArder.game_layer=null,g_elsfk.hasTouch=!1},init:function(){this.updateScore(),this.gamelogic=this.node.getComponent("els_gameLogic");var t=this.node.getChildByName("elsSoundManage");this.soundM=t.getComponent("els_soundManage"),!g_els_localData.getIsSoundClose()&&this.soundM.playBg(),this.isfirstIn=!0},onMassegeEvent:function(){g_oEvent.addEventListener(g_tEvent.ELS_PROPGET_BOX,function(t){this.showPropBox(t)}.bind(this)),g_oEvent.addEventListener(g_tEvent.ELS_DELETE_MAPBLOCK,function(t,e){this.deleteMapBlocks(t,e)}.bind(this)),g_oEvent.addEventListener(g_tEvent.ELS_PROP_USED,function(t,e){this.propUsed(t,e)}.bind(this)),g_oEvent.addEventListener(g_tEvent.ELS_UPDATE_SCORE,function(t,e,s){this.showAddScore(t,e,s)}.bind(this)),g_oEvent.addEventListener(g_tEvent.OUT_GAME,function(){this.onShowPause()}.bind(this))},showSettingView:function(t){var e=this,s=function(s){if(!t){if(g_els_localData.getIsNewStart())return void e.startGame();if(g_els_localData.getIfGameFailed())return g_els_localData.reSetUserData(),void e.startGame()}var i=cc.instantiate(s);cc.find("Canvas").addChild(i,20);var o=i.getComponent("els_settingView");o.setCfg(t),o.continueGame=function(){cc.find("Canvas").removeChild(i),!t&&e.startGame()},o.restartGame=function(){cc.find("Canvas").removeChild(i),g_els_localData.reSetUserData(),e.startGame()},o.backLobby=function(){cc.find("Canvas").removeChild(i),e.onbackToLobby()},o.playBgSound=function(t){t?e.soundM&&e.soundM.pauseBg():e.soundM&&e.soundM.playBg()}};if(t)this.setPrefab?s(this.setPrefab):g_resLoad.addPrefab("els_settingPrefab",function(t){e.setPrefab=t,s(e.setPrefab)},null,!0);else if(this.startPrefab){var i=cc.instantiate(this.startPrefab),o=i.getComponent("els_settingView");o.setCfg(t),o.continueGame=function(){cc.find("Canvas").removeChild(i),!t&&e.startGame()},o.continueGame()}else g_resLoad.addPrefab("els_startTipPrefab",function(s){e.startPrefab=s;var i=cc.instantiate(e.startPrefab),o=i.getComponent("els_settingView");o.setCfg(t),o.continueGame=function(){cc.find("Canvas").removeChild(i),!t&&e.startGame()},o.continueGame()},function(){e.startGame()},!0)},startGame:function(){this._isInGame=!0,this.isgameover=!1,this.propNode&&(this.propNode.active=!0),this.topnode&&(this.topnode.active=!0),this.soundM&&this.soundM.playStartGameSound(),this.touch_board.removeAllChildren(),this.map_board.removeAllChildren(),this.gamelogic.setStageId(10),this.mapBlocks=[],this.boomLists=[],this.blockGroupLists=[],this.createBlockGroup(),this.initMapGroup(),this.updateScore(),this.notCheckOver=!1},initMapGroup:function(){var t=this,e=function(){for(var e=0;e<g_els_localData.maxRow;e++){for(var s=[],i=0;i<g_els_localData.maxCol;i++){var o=cc.instantiate(t.mapBlockPrefab),a=t.gamelogic.getGridPosition(e,i);o.setPosition(a),t.map_board.addChild(o);var n=o.getComponent("els_mapblock"),c=g_els_localData.getLocalGridWithRC(e,i);null!=c&&(n.setBlockOpacity(255),n.setPreSpframe(t.frame_block[c]),n.changeSpriteframe(t.frame_block[c])),s.push(n)}t.mapBlocks.push(s)}t.checkBlockGroupCanPlace()};g_resLoad.addPrefab("els_mapblock",function(s){t.mapBlockPrefab=s,e()})},createBlockGroup:function(){this.bolckgroupCount=3,this.blockgroupArray={};var t=g_els_localData.getTeachStep();if(this._teachingStep=t,t<3){this.checkContinueTeach(!1);var e=0==t?1:1==t?5:2==t?9:void 0;void 0!==e&&(this.bolckgroupCount=1),this.createBlocks(e,1,0)}else this.createBlocks(void 0,3,-165),this.gamelogic.setStageId()},createBlocks:function(t,e,s,i){var o=this;e=e||3;var a=0,n=function(t){var e=g_Tool.getRandomInt(0,7),n=o.frame_block[e],c=o.blockGroupLists[t];if(c){var r=cc.instantiate(c);o.touch_board.addChild(r),r.setPosition(cc.v2(s,-370));var l=r.getComponent("els_blockGroup"),h=null!=i?i:a;l.setBlockInfo({sp:n,scale:.45,prefabid:h,colorid:e}),l.placeBack=function(t,e){r&&o.touch_board.removeChild(r),o.blockgroupArray[String(t)]=null,o.bolckgroupCount--,o.bolckgroupCount<=0?(o.notCheckOver=e,o._teachingStep<3&&g_els_localData.addTeachStep(),o.createBlockGroup()):o.checkBlockGroupCanPlace(e)},o.blockgroupArray[String(h)]=l}s+=165,a++};(function t(s){if(a>=e)return o.checkBlockGroupCanPlace(o.notCheckOver),void(o.notCheckOver=!1);s=null!=s?s:o.gamelogic.getBlockGroupId(),o.blockGroupLists[s]?(n(s),t()):g_resLoad.addPrefab("els_blocks_"+s,function(e){o.blockGroupLists[s]=e,n(s),t()},null,!1)})(t)},changeMapBlockWhenTeach:function(){for(var t=0;t<g_els_localData.maxRow;t++)for(var e=0;e<g_els_localData.maxCol;e++){var s=g_els_localData.getLocalGridWithRC(t,e);if(null!=s&&this.mapBlocks&&this.mapBlocks[t]&&this.mapBlocks[t][e]){var i=this.mapBlocks[t][e];i.setBlockOpacity(255),i.setPreSpframe(this.frame_block[s]),i.changeSpriteframe(this.frame_block[s])}}},onbtnBackClick:function(){this.soundM&&this.soundM.playTouchSound(),this.showSettingView(!0)},onShowPause:function(){this._isInGame&&this.onbtnBackClick()},onbackToLobby:function(){this.soundM&&this.soundM.pauseBg(),this.clearBlockgroupArray(),this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){g_wanxArder.backToLobby()}.bind(this))))},updateDiamondCount:function(t){t=t||0,g_oEvent.dispatchEvent(g_tEvent.UPDATEDIAMON,t)},showAddScore:function(t,e,s){var i=this;this.add_score=this.add_score||0,this.add_score+=t%10,this.pre_score=g_els_localData.getCurTotal()-t,this.pre_hist=e,this.histroy_s=g_els_localData.getHistoryScore();var o=t-this.add_score;if(this.els_scorePre&&o>=10){var a=cc.instantiate(this.els_scorePre);if(a){cc.find("Canvas").addChild(a,14);var n=this.lab_curtotal.node.getPosition();s.y>n.y-160&&(s.y=s.y-160),a.setPosition(s),a.getComponent("cc.Label").string="+"+o;var c=g_Tool.getRandom(.5,1);a.runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.3,1.1,1.1),cc.scaleTo(.4,1,1),cc.moveTo(c,n),cc.callFunc(function(){cc.find("Canvas").removeChild(a),i.updateScore()})))}}this.add_score>0&&this.schedule(this.addScoreByTime,.1)},addScoreByTime:function(){this.pre_score++,this.add_score--,this.lab_curtotal.string=this.pre_score+"",this.pre_hist=this.pre_hist<this.histroy_s?++this.pre_hist:this.histroy_s,this.lab_histroy.string="\u5386\u53f2\u6700\u9ad8\uff1a "+this.pre_hist,this.add_score<=0&&this.unschedule(this.addScoreByTime)},updateScore:function(){this.lab_histroy.string="\u5386\u53f2\u6700\u9ad8\uff1a "+g_els_localData.getHistoryScore(),this.lab_curtotal.string=""+g_els_localData.getCurTotal()},checkBlockGroupCanPlace:function(t){if(!this.isgameover){var e=!1,s=0,i=!0,o=[];for(var a in this.blockgroupArray){var n=this.blockgroupArray[a];if(n){s++;var c=n.checkHasPlaceToPut();e=e||c,i=i&&c,o[a]=c}}if(t||(0==s&&(e=!0,i=!0),this._checktime=null==this._checktime?20:this._checktime,this._checktime++,this.dealPopBox(!e,!i)),this.boomM){var r=!1;this.gamelogic&&(r=this.gamelogic.getIsPlayAnim()),this.boomM.setBoomActive(o,!r,this.refreshact)}}},dealPopBox:function(t,e){var s,i=g_els_localData.getPropCount(0),o=g_els_localData.getPropCount(1);if(s=i>0&&o>0?g_Tool.getRandomInt(0,2)-2:i>0?-2:o>0?-1:g_Tool.getRandomInt(0,2),t){if(s<0)return g_wanxArder.dialog_active||this.showRecomdItemBox(s+2),void(this._checktime=0);this.isgameover=!0,g_els_localData.checkSendData();var a=g_wanxArder.ComponentIsValid(this)?this:g_wanxArder.game_layer;a.node.runAction(cc.sequence(cc.delayTime(.4),cc.callFunc(function(){this.showReviveView()}.bind(a))))}else if(e){var n=g_Tool.getRandomInt(0,2);if(this.refreshImg.active=0==n,this.refreshact=0==n,g_els_localData.getIsFirstAutoProp())return Tips.showToast("\u6ce8\u610f\u4e86~\u51fa\u73b0\u7070\u8272\u65b9\u5757\u8868\u793a\u65b9\u5757\u4e0d\u53ef\u62d6\u52a8\u81f3\u68cb\u76d8\u54e6\uff0c\n \u5feb\u4f7f\u7528\u9053\u5177\u52a9\u529b\u5427"),void g_els_localData.setIsFirstAutoProp();this._checktime>this._propLimit&&(this._checktime=0,s>=0?this.showPropBox(s):this.showRecomdItemBox(s+2))}else this.refreshImg.active=!1,this.refreshact=!1,this.gamelogic.getRedpackFlag()&&this.showHbView();this.gamelogic.setRedpackFlag(!1)},showHbView:function(){g_oEvent.dispatchEvent(g_tEvent.OPEN_REDPACK,2)},showReviveView:function(){var t=this,e=function(){g_els_localData.setIfGameFailed(1);var e=cc.instantiate(t.revivePrefab);cc.find("Canvas").addChild(e,20),t.reviveViewNode=e;var s=e.getComponent("els_reviveView");s.reviveGame=function(){t.updateDiamondCount(),e&&cc.find("Canvas").removeChild(e),g_els_localData.setIfGameFailed(0),t.reviveCurrentGame()},s.closeBack=function(s){e&&cc.find("Canvas").removeChild(e),t._hasPlaySp=s,t.showGameOver()}};this.revivePrefab?e():g_resLoad.addPrefab("els_revivePrefab",function(s){t.revivePrefab=s,e()},function(){t.showGameOver()},!0)},showReviveViewBegin:function(){var t=this,e=function(){var e=cc.instantiate(t.gameReviveBegin);cc.find("Canvas").addChild(e,19),t.gameReviveBeginNode=e,e.getComponent("els_gameReviveBegin").closeBack=function(){t.showReviveView()}};this.gameReviveBegin?e():g_resLoad.addPrefab("els_gameReviveBegin",function(s){t.gameReviveBegin=s,e()},function(){},!0)},closeReviveViewBegin:function(){this.gameReviveBeginNode&&this.gameReviveBeginNode.destroy()},onClickRank:function(){},showGameOver:function(){var t=this,e=function(){if(g_wanxArder.ComponentIsValid(t)){var e=cc.instantiate(t.gameoverPre);cc.find("Canvas").addChild(e,20),t.soundM&&t.soundM.playOverSound();var s=g_els_localData.getCurTotal(),i=e.getComponent("els_gameover"),o=!1;!t._hasPlaySp&&t.gamelogic&&t.gamelogic.getCanHasOverCp()&&(o=!0),t._hasPlaySp=!1,g_hx_sdk.postMessageScore(s),i.setGameScore(s,o),g_els_localData.reSetUserData(),t.clearBlockgroupArray(),t.boomM&&t.boomM.setBoomActive([],!1),t.mapBlocks.splice(0),i.gameAgain=function(){cc.find("Canvas").removeChild(e),t.startGame()},i.back=function(){cc.find("Canvas").removeChild(e),t.onbackToLobby()},i.playsound=function(e){e?t.soundM&&t.soundM.pauseBg():t.soundM&&t.soundM.playBg()}}else g_wanxArder.backToLobby()};this.gameoverPre?e():g_resLoad.addPrefab("els_gameoverPrefab",function(s){t.gameoverPre=s,e()},function(){t.onbackToLobby()},!0)},reviveCurrentGame:function(){this.isgameover=!1,this.gamelogic&&this.gamelogic.setStageId(1);for(var t=0,e=[],s=[],i=0;i<g_els_localData.maxRow;i++)for(var o=0;o<g_els_localData.maxCol;o++){null!=g_els_localData.getLocalGridWithRC(i,o)&&e.unshift({r:i,c:o})}for(var a=Math.floor(e.length/2);t<a;){var n=g_Tool.getRandomInt(0,e.length);e[n]&&(s.unshift(e[n]),e.splice(n,1),t++)}this.clearBlockgroupArray();var c=[];c.push(s),this.daideleteScope=s,this.deleteMapBlocks(c),this.notCheckOver=!0,this.createBlockGroup()},clearBlockgroupArray:function(){for(var t in this.blockgroupArray){var e=this.blockgroupArray[t];e&&(e.node.destroy(),this.blockgroupArray[t]=null)}},showPropBox:function(t){var e=this,s=function(){var s=cc.instantiate(e.propBoxPrefab);cc.find("Canvas").addChild(s,20);var i=s.getComponent("els_propBox");i.setCfg(t),i.cbget=function(t){if(cc.find("Canvas").removeChild(s),0==t||1==t){var i=0==t?"\u606d\u559c\u83b7\u5f971\u4e2a\u9524\u5b50":1==t?"\u606d\u559c\u83b7\u5f971\u6b21\u201c\u6362\u4e00\u6362\u201d\u673a\u4f1a":"";""!==i&&Tips.showToast(i),g_els_localData.changePropCount(t,1),e.updatePropCount()}else 2==t&&e.boomM&&e.boomM.playBoomAnim();e.updateDiamondCount()},i.closecb=function(){cc.find("Canvas").removeChild(s)}};this.propBoxPrefab?s():g_resLoad.addPrefab("els_propPrefab",function(t){e.propBoxPrefab=t,s()},null,!0)},showRecomdItemBox:function(t){var e=this,s=function(){var s=cc.instantiate(e.tjdjPrefab);cc.find("Canvas").addChild(s,20);var i=s.getComponent("els_tjdjBox");i.setCfg(t),i.usedBack=function(){cc.find("Canvas").removeChild(s),1==t&&e.propUsed(t)},i.closeBack=function(){cc.find("Canvas").removeChild(s)}};this.tjdjPrefab?s():g_resLoad.addPrefab("els_tjdjPrefab",function(t){e.tjdjPrefab=t,s()},null,!0)},updatePropCount:function(){this.chuiziCount.string="x"+g_els_localData.getPropCount(0),this.chongzhiCount.string="x"+g_els_localData.getPropCount(1)+"/3"},deleteMapBlocks:function(t,e,s){var i=this;this._teachNode&&(this._teachNode.active=!1);var o=t.slice(0,t.length),a=g_wanxArder.ComponentIsValid(this)?this:g_wanxArder.game_layer,n=!1;this.gamelogic&&this.gamelogic.setIsPlayAnim(!0);var c=function s(){var c=t.shift();if(!c)return g_els_localData.deleteGridScopes(o),i.gamelogic&&i.gamelogic.setIsPlayAnim(!1),a.checkBlockGroupCanPlace(),a.checkContinueTeach(!0),void a.node.runAction(cc.sequence(cc.delayTime(1.1),cc.callFunc(function(){a.blockAnimNode&&a.blockAnimNode.removeAllChildren()}.bind(a))));for(var r=0;r<c.length;r++){var l=c[r];if(a.mapBlocks&&a.mapBlocks[l.r]&&a.mapBlocks[l.r][l.c]){var h=a.mapBlocks[l.r][l.c];if(0!=h.getBlockOpacity()){h.deleteBlockActin(n);var u=h.getBlockPosition(),d=e;null==d&&(d=g_els_localData.getLocalGridWithRC(l.r,l.c)),a.boomLists.unshift({r:l.r,c:l.c,p:u,color:d}),a.playBlockAnim()}}}var _=t&&t.length>0?.05:.7;n=!0,a.node.runAction(cc.sequence(cc.delayTime(_),cc.callFunc(function(){s()}.bind(a))))};s=s||.11,a.node.runAction(cc.sequence(cc.delayTime(s),cc.callFunc(function(){a.soundM&&a.soundM.playXiaochuSound(),c()}.bind(a))))},playBlockAnim:function(){var t=this,e=this.boomLists.pop(),o=function(e,s){var i=cc.instantiate(t.blockAnimPre[e]);t.blockAnimNode.addChild(i,1),i.setPosition(s)},a=function(s){var i=cc.instantiate(t.blockLzPre[s]);t.blockAnimNode.addChild(i,3),i.setPosition(e.p)},n=e.color;if(this.blockLzPre[n])a(n);else{var c=s[n];g_resLoad.addPrefab(c,function(e){t.blockLzPre[n]=e,a(n)})}var r=(e.r+e.c)%2*8+n;if(this.blockAnimPre[r])o(r,e.p);else{var l=(e.r+e.c)%2==0?"01":"02",h=i[n]+l;this.animIdLists=this.animIdLists||[],this.animIdLists.unshift({id:r,p:e.p,n:h}),g_resLoad.addPrefab(h,function(s){for(var i=t.animIdLists.length-1;i>=0;i--){var a=t.animIdLists[i];if(a&&a.n==s._name){var n=a.id||r,c=a.p||e.p;t.blockAnimPre[n]=s,o(n,c),t.animIdLists.splice(i,1)}}})}},propUsed:function(t,e){if(0==t){if(e&&e.length>0){this.soundM&&this.soundM.playChuiZiSound(),this.daideleteScope=e;var s=[];s.push(e),this.deleteMapBlocks(s,null,.27)}}else 1==t&&(this.clearBlockgroupArray(),this.gamelogic&&this.gamelogic.setStageId(2),this.notCheckOver=!1,this.createBlockGroup());g_els_localData.changePropCount(t,-1),this.updatePropCount()},checkContinueTeach:function(t){var e=this,s=function(){if(e._teachNode){e._teachNode.active=!0;var t=e.gamelogic.getTeachRects(e._teachingStep);e._teachNode.getComponent("els_teach").setElsMaskGrid(e._teachingStep,t,{x:0,y:-380})}else{var s=cc.instantiate(e._teachPrefab);e._teachNode=s,e.teachParent.addChild(s);var i=s.getComponent("els_teach");t=e.gamelogic.getTeachRects(e._teachingStep),i.setElsMaskGrid(e._teachingStep,t,{x:0,y:-380})}},i=function(){g_els_localData.addTeachingGrid(e._teachingStep),e._teachPrefab?s():g_resLoad.addPrefab("els_teachPrefab",function(t){e._teachPrefab=t,s()},null,!0)};this._teachingStep<3?t?(i(),this.changeMapBlockWhenTeach()):t||this._isdelayDel||(this._isdelayDel=!0,i()):(3==this._teachingStep&&(g_els_localData.addTeachStep(),Tips.showToast("\u4fdd\u6301\u5feb\u4e50\u5fc3\u60c5\uff0c\u795d\u4f60\u6e38\u620f\u6109\u5feb~")),this._teachNode&&(this.teachParent.removeChild(this._teachNode),this._teachNode=null))},listenBoom:function(){var t=this;this.boomM=this.els_boomItem.getComponent("els_groupBoom"),this.boomM.blockBoom=function(e){var s=e;if(t.blockgroupArray){var i=t.blockgroupArray[s];i&&(i.node.destroy(),t.blockgroupArray[s]=null)}var o=165*e-165;t.createBlocks(0,1,o,s)}}}),cc._RF.pop()},{els_localData:"els_localData"}],els_gameLogic:[function(t,e){"use strict";cc._RF.push(e,"a282eaoqShKy5DEYAbvEGDC","els_gameLogic");var s=[0,1,0,1,0,2,0,2,0,3,0,3,0,2,2,2];cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.arrayLists1=[0,1,2,5,6,11],this.arrayLists2=[0,1,2,5,6,11,3,7,9,13,14],this.stageId=10},start:function(){this._isplayAnim=!1},getBlockGroupId:function(){switch(this.stageId){case 1:case 2:var t=g_Tool.getRandomInt(0,this.arrayLists1.length);return this.arrayLists1[t];case 3:case 4:return t=g_Tool.getRandomInt(0,this.arrayLists2.length),this.arrayLists2[t];default:return g_Tool.getRandomInt(0,16)}},setStageId:function(t){t?this.stageId=t:this.stageId++},getIsOverBoard:function(t){var e=67*(g_els_localData.maxRow-.5)-314+3*(g_els_localData.maxRow-1),s=67*(g_els_localData.maxCol-.5)-224+3*(g_els_localData.maxCol-1);return t.x<-347.5||t.x>e||t.y<-257.5||t.y>s},getWith_Height:function(t){var e=s[t];return 1==e?{w:33.5,h:100}:2==e?{w:0,h:66.5}:3==e?{w:33.5,h:66.5}:{w:0,h:100}},getGridPosition:function(t,e){return{x:67*t-314+3*(t>0?t-1:0),y:67*e-224+3*(e>0?e-1:0)}},getGridRC:function(t){if(this.getIsOverBoard(t))return null;var e=Math.round((t.x- -314)/70),s=Math.round((t.y- -224)/70);return{r:e=e>0?e:0,c:s=s>0?s:0}},getDeleteScore:function(t){return t<=1?10:30*(t-1)},setRedpackFlag:function(t){this._popRedpack=t},getRedpackFlag:function(){return this._popRedpack},checkHasRedpack:function(){this.setRedpackFlag(!1)},getTeachRects:function(t){var e=[],s=g_els_localData.getTeachFillGrid(t);if(s&&s.length>0)for(var i=0;i<s.length;i++){var o=s[i],a=this.getGridPosition(o.r,o.c),n={x:a.x,y:a.y,width:70,height:70};e.push(n)}return e},setIsPlayAnim:function(t){this._isplayAnim=t},getIsPlayAnim:function(){return this._isplayAnim},getCanHasOverCp:function(){return!g_arder_gmsc.getNotVedio()&&(null==this._overcprate&&(this._overcprate=g_arder_gmsc.getElsOverCpRate()),void 0!==this._overcprate&&g_Tool.getRandom()<this._overcprate)},getSettingCp:function(){return!g_arder_gmsc.getNotVedio()&&(null==this._pausecprate&&(this._pausecprate=g_arder_gmsc.getElsPauseCpRate()),void 0!==this._pausecprate&&g_Tool.getRandom()<this._pausecprate)}}),cc._RF.pop()},{}],els_gameReviveBegin:[function(t,e){"use strict";cc._RF.push(e,"58b14YV84lKG4zUIDUDLoa2","els_gameReviveBegin"),cc.Class({extends:cc.Component,properties:{tipsLab:cc.Node},start:function(){this.playAnim()},playAnim:function(){if(this.tipsLab){this.tipsLab.opacity=0;var t=cc.delayTime(2),e=cc.fadeTo(.5,255);this.tipsLab.runAction(cc.sequence(t,e))}},clickClose:function(){this.closeBack&&this.closeBack(),this.node&&cc.isValid(this.node)&&this.node.destroy()}}),cc._RF.pop()},{}],els_gameover:[function(t,e){"use strict";cc._RF.push(e,"ff8cfpkpTFHJKdHNwK0bllj","els_gameover"),cc.Class({extends:cc.Component,properties:{curScore:cc.Label,hightScore:cc.Label},onLoad:function(){g_Tool.debugInfo("debugInfo  >> ","els gameover"),g_els_localData.getIsSoundClose(),this.soundM=g_wanxArder.game_layer.soundM,g_wxPlat.showInterstitialAd(),g_hx_sdk.report(11)},setGameScore:function(t){this.curScore.string=t,this.hightScore.string="\u5386\u53f2\u6700\u9ad8\u5206\uff1a "+g_els_localData.getHistoryScore()},onbtnBackClick:function(){this.soundM&&this.soundM.playTouchSound(),this.closePanel(),this.back&&this.back()},onbtnAgainClick:function(){this.soundM&&this.soundM.playTouchSound(),this.closePanel(),this.gameAgain&&this.gameAgain()},closePanel:function(){}}),cc._RF.pop()},{}],els_groupBoom:[function(t,e){"use strict";cc._RF.push(e,"65544bEtX9GNJ4aavpP1uoI","els_groupBoom"),cc.Class({extends:cc.Component,properties:{items:[cc.Node]},onLoad:function(){if(this.items)for(var t=0;t<this.items.length;t++)this.items[t]&&(this.items[t].active=!0);var e=dragonBones.EventObject;if(this.boomDragon_0=this.getBoomDragonbones(0),this.boomDragon_0&&this.boomDragon_0.addEventListener(e.LOOP_COMPLETE,function(t){t.type==e.LOOP_COMPLETE&&("boom"==this.boomDragon_0._animationName&&this.blockBoom("0"),this.boomDragon_0.playAnimation("move"))}.bind(this)),this.boomDragon_1=this.getBoomDragonbones(1),this.boomDragon_1&&this.boomDragon_1.addEventListener(e.LOOP_COMPLETE,function(t){t.type==e.LOOP_COMPLETE&&("boom"==this.boomDragon_1._animationName&&this.blockBoom("1"),this.boomDragon_1.playAnimation("move"))}.bind(this)),this.boomDragon_2=this.getBoomDragonbones(2),this.boomDragon_2&&this.boomDragon_2.addEventListener(e.LOOP_COMPLETE,function(t){t.type==e.LOOP_COMPLETE&&("boom"==this.boomDragon_2._animationName&&this.blockBoom("2"),this.boomDragon_2.playAnimation("move"))}.bind(this)),this.items)for(t=0;t<this.items.length;t++)this.items[t]&&(this.items[t].active=!1)},getBoomDragonbones:function(t){if(this.items&&this.items[t]){var e=this.items[t].getChildByName("eluosi_boom");if(e)return e.getComponent(dragonBones.ArmatureDisplay)}return null},setBoomActive:function(t,e,s){var i=!1;s=null!=s&&s;for(var o=this.items.length,a=0;a<o;a++){var n=this.items[a],c=t[String(a)];null!=c&&null!=c||(c=!0),n.active=!c;var r=n.getChildByName("boomts");r.active=!1,c?n.active=!1:(n.active=!0,i||s||(r.active=!0,i=!0))}this._cantouch=e},playBoomAnim:function(){if(this.blockBoom&&void 0!==this._touchindex){this._cantouch=!1;var t=this._touchindex;"0"==t&&this.boomDragon_0?this.boomDragon_0.playAnimation("boom"):"1"==t&&this.boomDragon_1?this.boomDragon_1.playAnimation("boom"):"2"==t&&this.boomDragon_2?this.boomDragon_2.playAnimation("boom"):this.blockBoom(t),this._touchindex=void 0}},onBoomClick:function(t,e){this._cantouch&&(this._touchindex=e,g_oEvent.dispatchEvent(g_tEvent.ELS_PROPGET_BOX,2))}}),cc._RF.pop()},{}],els_localData:[function(t,e){"use strict";cc._RF.push(e,"29339EswctDPIfMbyFupU+J","els_localData");var s=!1,i=!1,o={maxRow:10,maxCol:10,saveLocalData:function(t,e){if(null!=e&&""!==e){var s=JSON.stringify(e);g_hx_sdk.setStorage(t,s)}},getLocalData:function(t,e){var s=g_hx_sdk.getStorage(t);return s?JSON.parse(s):e},_init:function(){i||(i=!0,this.initUserData(),this.initPropCount(),this._isSoundClose=this.getLocalData("els_soundstate",0),this.teachCurStep=this.getLocalData("els_teachStep",0),this.initTeachGrid(),this.els_userdata&&this.els_userdata.elsHistory&&0==this.teachCurStep&&this.addTeachStep(2))},initUserData:function(){this.els_userdata={elsHistory:0,elsTotal:0,elsGrids:[],lifeLeft:3,isfaile:0};var t=this.getLocalData("els_userdata",{});t&&""!==t&&(this.els_userdata.elsHistory=t.elsHistory||0,this.els_userdata.elsTotal=t.elsTotal||0,this.els_userdata.elsGrids=t.elsGrids||[],this.els_userdata.lifeLeft=t.lifeLeft||3,this.els_userdata.isfaile=t.isfaile||0),this.preSendScore=this.els_userdata.elsHistory,void 0===this._serverScore||s||this.compareUserData()},initPropCount:function(){var t=(new Date).getDate();this.els_propCount={date:t,autotime:0,0:0,1:0,2:0};var e=this.getLocalData("els_propCount",{});e&&""!==e&&(this.els_propCount.date=e.date||0,this.els_propCount.autotime=e.autotime||0,this.els_propCount[0]=e[0]||0,this.els_propCount[1]=e[1]||0,this.els_propCount[2]=e[2]||0),this.els_propCount.date!==t&&(this.els_propCount.date=t,this.els_propCount.autotime=0,this.els_propCount[1]=1)},setHistroyWithSever:function(t){this._serverScore=t,this.els_userdata&&this.compareUserData()},compareUserData:function(){if(s=!0,this.els_userdata.elsHistory<this._serverScore)this.els_userdata.elsHistory=this._serverScore,this.els_userdata.elsTotal=0,this.els_userdata.elsGrids=[],this.saveLocalData("els_userdata",this.els_userdata);else if(this.els_userdata.elsHistory-this._serverScore>50){var t={elsHistory:this.els_userdata.elsHistory};g_wanxArder.userinfos.onPostUserInfo_els(t)}},reSetUserData:function(){this.els_userdata&&(this.els_userdata.elsTotal=0,this.els_userdata.elsGrids=[],this.els_userdata.lifeLeft=3,this.els_userdata.isfaile=0,this.saveLocalData("els_userdata",this.els_userdata))},getIsNewStart:function(){return!(this.els_userdata&&this.els_userdata.elsTotal>0)},getIfGameFailed:function(){return!!this.els_userdata&&1==this.els_userdata.isfaile},setIfGameFailed:function(t){this.els_userdata&&(this.els_userdata.isfaile=t,this.saveLocalData("els_userdata",this.els_userdata))},getIsSoundClose:function(){return 1==this._isSoundClose},setIsSoundClose:function(t){this._isSoundClose=t?1:0,this.saveLocalData("els_soundstate",this._isSoundClose)},getCurTotal:function(){return this.els_userdata&&this.els_userdata.elsTotal?this.els_userdata.elsTotal:0},getHistoryScore:function(){return this.els_userdata&&this.els_userdata.elsHistory?this.els_userdata.elsHistory:0},setReviveLeftLife:function(){this.els_userdata&&(this.els_userdata.lifeLeft--,this.els_userdata.lifeLeft=this.els_userdata.lifeLeft>0?this.els_userdata.lifeLeft:0,this.saveLocalData("els_userdata",this.els_userdata))},getReviveLeftLife:function(){return this.els_userdata&&this.els_userdata.lifeLeft||0},saveGameData:function(t,e,s){if(this.els_userdata){var i=this.els_userdata.elsTotal||0;i+=t,this.els_userdata.elsTotal=i;var o=this.els_userdata.elsHistory||0;this.els_userdata.elsHistory=o>i?o:i;for(var a=0;a<e.length;a++){var n=e[a];n&&(this.els_userdata.elsGrids[n.r]=this.els_userdata.elsGrids[n.r]||[],this.els_userdata.elsGrids[n.r][n.c]=s)}this.saveLocalData("els_userdata",this.els_userdata);var c=this.els_userdata.elsHistory;if(c>0&&c-this.preSendScore>=30){var r={elsHistory:c};this.preSendScore=c,g_wanxArder.userinfos.onPostUserInfo_els(r),g_wanxArder.userinfos.resetRankData_els()}}},deleteGameData:function(t){for(var e=0;e<t.length;e++){var s=t[e];if(s){var i=s.split("_"),o=parseInt(i[1]);if("row"==i[0]){if(this.els_userdata.elsGrids[o])for(var a=0;a<g_els_localData.maxCol;a++)this.els_userdata.elsGrids[o][a]=void 0}else if("col"==i[0])for(a=0;a<g_els_localData.maxRow;a++)this.els_userdata.elsGrids[a]&&(this.els_userdata.elsGrids[a][o]=void 0)}}this.saveLocalData("els_userdata",this.els_userdata)},deleteGridsWithRC:function(t){if(this.els_userdata&&this.els_userdata.elsGrids){for(var e=0;e<t.length;e++){var s=t[e];this.els_userdata.elsGrids[s.r]&&this.els_userdata.elsGrids[s.r][s.c]&&(this.els_userdata.elsGrids[s.r][s.c]=void 0)}this.saveLocalData("els_userdata",this.els_userdata)}},deleteGridScopes:function(t){if(this.els_userdata&&this.els_userdata.elsGrids&&t){for(var e=0;e<t.length;e++){var s=t[e];if(s&&s.length>0)for(var i=0;i<s.length;i++){var o=s[i];this.els_userdata.elsGrids[o.r]&&(this.els_userdata.elsGrids[o.r][o.c]=void 0)}}this.saveLocalData("els_userdata",this.els_userdata)}},checkSendData:function(){if(this.els_userdata){var t=this.els_userdata.elsHistory;if(t>this.preSendScore){var e={elsHistory:t};this.preSendScore=t,g_wanxArder.userinfos.onPostUserInfo_els(e),g_wanxArder.userinfos.resetRankData_els()}}},getLocalGridWithRC:function(t,e){if(this.els_userdata&&this.els_userdata.elsGrids){var s=this.els_userdata.elsGrids[t];return s?s[e]:void 0}},getPropCount:function(t){return this.els_propCount&&this.els_propCount[String(t)]||0},changePropCount:function(t,e){this.els_propCount&&(this.els_propCount[String(t)]=this.els_propCount[String(t)]||0,this.els_propCount[String(t)]+=e,this.saveLocalData("els_propCount",this.els_propCount))},setIsFirstAutoProp:function(){this.els_propCount&&(this.els_propCount.autotime=this.els_propCount.autotime||0,this.els_propCount.autotime++,this.saveLocalData("els_propCount",this.els_propCount))},getIsFirstAutoProp:function(){return!!this.els_propCount&&(this.els_propCount.autotime=this.els_propCount.autotime||0,0==this.els_propCount.autotime)},initTeachGrid:function(){this.teachFillGrid=[],this.teachFillGrid[0]=[{r:4,c:4},{r:5,c:4}],this.teachFillGrid[1]=[{r:4,c:4},{r:4,c:5}],this.teachFillGrid[2]=[{r:4,c:4},{r:4,c:5},{r:5,c:4},{r:5,c:5}]},getTeachFillGrid:function(t){if(this.teachFillGrid)return this.teachFillGrid[t]},getTeachStep:function(){return void 0!==this.teachCurStep?this.teachCurStep:3},addTeachStep:function(t){this.teachCurStep=this.teachCurStep||0,void 0!==t&&(this.teachCurStep=t),this.teachCurStep++,this.saveLocalData("els_teachStep",this.teachCurStep)},addTeachingGrid:function(t){var e=[];if(0==t?e=[5,5,5,5,5,5,5,5]:1==t?e=[2,2,1,1,2,2,2,0,0,2,2,2,0,0,3,3,0,0]:2==t&&(e=[6,6,6,6,4,4,4,4,6,6,4,4,4,4,6,6,6,6,4,4,4,4,6,6,4,4,4,4,6,6,6,6]),e.length>0&&this.els_userdata&&this.els_userdata.elsGrids){var s=0;if(0==t)for(var i=0;i<10;i++)this.els_userdata.elsGrids[i]=this.els_userdata.elsGrids[i]||[],4!==i&&5!==i&&(this.els_userdata.elsGrids[i][4]=e[s],s++);else if(1==t)for(i=0;i<10;i++){this.els_userdata.elsGrids[i]=this.els_userdata.elsGrids[i]||[];for(var o=4;o<6;o++)4!==i&&(this.els_userdata.elsGrids[i][o]=e[s],s++)}else if(2==t)for(i=0;i<10;i++)if(this.els_userdata.elsGrids[i]=this.els_userdata.elsGrids[i]||[],i<4||i>5)for(o=4;o<6;o++)this.els_userdata.elsGrids[i][o]=e[s],s++;else for(o=0;o<10;o++)4!==o&&5!==o&&(this.els_userdata.elsGrids[i][o]=e[s],s++)}}};e.exports=o,cc._RF.pop()},{}],els_mapblock:[function(t,e){"use strict";cc._RF.push(e,"287ec3yKxNH/aX1wIttoJ8k","els_mapblock"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.preframe=null},start:function(){},setBlockVisit:function(t){this._visit=t},getBlockVisit:function(){return this._visit},setPreSpframe:function(t){this.preframe=t},getBlockPosition:function(){return this.node.getPosition()},changeToPreFrame:function(){if(255==this.node.opacity){var t=this.node.getComponent("cc.Sprite");t&&(t.spriteFrame=this.preframe)}},changeSpriteframe:function(t){var e=this.node.getComponent("cc.Sprite");e&&(e.spriteFrame=t)},setBlockOpacity:function(t){255!==this.node.opacity&&(this.node.opacity=t)},getBlockOpacity:function(){return this.node.opacity},doPlaceAction:function(){this.node.scale=.9,this.node.opacity=255,this.node.runAction(cc.scaleTo(.08,1))},deleteBlockActin:function(t){var e=cc.scaleTo(.1,1.12),s=cc.scaleTo(.17,0),i=cc.callFunc(function(){this.node.opacity=0,this.node.scale=1}.bind(this));t?this.node.runAction(cc.sequence(e,s,i)):this.node.runAction(cc.sequence(s,i))}}),cc._RF.pop()},{}],els_propBox:[function(t,e){"use strict";cc._RF.push(e,"3b1e9yXkIJMSrN7EgAZfZEM","els_propBox");var s=["\u9524\u5b50\u62d6\u81f3\u76ee\u6807\u4f4d\u7f6e\uff0c\u53ef\u6572\u788e3*3\u7684\u65b9\u5757","\u5feb\u83b7\u5f97\u4e00\u6b21\u201c\u6362\u4e00\u6362\u201d\u7684\u673a\u4f1a\u5427","\u201c\u70b8\u5f39\u201d\u9053\u5177\u53ef\u4ee5\u628a\u65b9\u5757\u70b8\u62101\u683c\u54e6"],i=["\u9524\u5b50","\u6362\u4e00\u6362","\u70b8\u5f39"];cc.Class({extends:cc.Component,properties:{sysm:cc.Label,daojutu:cc.Sprite,frame_dj:[cc.SpriteFrame],btnvedio:cc.Node},start:function(){this.soundM=g_wanxArder.game_layer.soundM,g_hx_sdk.report(5)},setCfg:function(t){t=t||0,this.daojuid=t,this.sysm.string=s[t],this.daojutu&&(this.daojutu.spriteFrame=this.frame_dj[t])},onbtnCannelClick:function(){this.soundM&&this.soundM.playTouchSound(),this.closePanel()},onbtnUsedDiamondClick:function(){var t=this;if(this.soundM&&this.soundM.playTouchSound(),g_fkwxxx_locData.getStars()>=20){if(!g_arder_plat.getNetState())return void Tips.showToast("\u5f53\u524d\u7f51\u7edc\u5dee\uff0c\u91cd\u65b0\u94fe\u63a5\u7f51\u7edc\u8bd5\u8bd5");var e="\u94bb\u77f3\u6d88\u8017-\u6d88\u65b9\u5757\u4e2d\u8d2d\u4e70"+i[this.daojuid];g_fkwxxx_locData.saveStarCount(-20,e),this.closePanel(!0)}else this.removeYsAd(),g_oEvent.dispatchEvent(g_tEvent.SHOW_SHOP,"game",null,0,function(){t.addYsAd()})},onbtnGetClick:function(){var t=this;this.soundM&&this.soundM.playTouchSound(),g_wxPlat.showVideoAd(function(){t.closePanel(!0)},function(){})},clickClosePanel:function(){this.closePanel(!1)},closePanel:function(t){t?this.cbget&&this.cbget(this.daojuid):this.closecb&&this.closecb(),this.removeYsAd()},addYsAd:function(){},removeYsAd:function(){}}),cc._RF.pop()},{}],els_propTouch:[function(t,e){"use strict";cc._RF.push(e,"b2a24GIXLdEsI+6UmlH5Prp","els_propTouch"),cc.Class({extends:cc.Component,properties:{touchidx:0,chuizi:cc.Node,syts:cc.Node},start:function(){this.fingerHeight=160,this.chuizicz={x:280,y:360},this.addAnimListern(),this.addTouchEvent(),g_wanxArder.game_layer&&(this.gamelogic=g_wanxArder.game_layer.gamelogic,this.soundM=g_wanxArder.game_layer.soundM),this.hastouchstart=!1},addAnimListern:function(){this.chuizi&&(this.chuiziDragon=this.chuizi.getComponent(dragonBones.ArmatureDisplay),this.chuiziDragon.addEventListener(dragonBones.EventObject.COMPLETE,function(t){t.type==dragonBones.EventObject.COMPLETE&&"eluosi_chuizi"==this.chuiziDragon._animationName&&this.chuizi&&(this.chuizi.setPosition(cc.v2(0,0)),this.chuizi.active=!1)}.bind(this)))},addTouchEvent:function(){this.node.on("touchstart",this.touchStart,this),this.node.on("touchmove",this.touchMove,this),this.node.on("touchend",this.touchFinish,this),this.node.on("touchcancel",this.touchFinish,this)},onDestroy:function(){this.node.off("touchstart",this.touchStart,this),this.node.off("touchmove",this.touchMove,this),this.node.off("touchend",this.touchFinish,this),this.node.off("touchcancel",this.touchFinish,this)},touchStart:function(){this.soundM&&this.soundM.playTouchSound(),this._count=g_els_localData.getPropCount(this.touchidx),g_elsfk.hasTouch||(this.hastouchstart=!0,this._count<=0||0!==this.touchidx||(g_elsfk.hasTouch=!0,this.beginePos=this.node.getPosition(),this.chuizi&&(this.chuizi.active=!0,this.chuizi.y=this.beginePos.y+this.chuizicz.y+this.fingerHeight,this.chuizi.x=this.beginePos.y+this.chuizicz.x,this.chuiziDragon&&this.chuiziDragon.playAnimation("eluosi_chuizi_1")),this.syts&&(this.syts.active=!0)))},touchMove:function(t){if(null!=this._count&&null!=this._count||(this._count=g_els_localData.getPropCount(this.touchidx)),!(this._count<=0||0!==this.touchidx)&&this.hastouchstart){var e=t.getLocation(),s=e.x,i=e.y,o=this.node.parent.convertToNodeSpaceAR(cc.v2(s,i));o.x+=this.chuizicz.x,o.y+=this.chuizicz.y+this.fingerHeight,this.chuizi&&this.chuizi.setPosition(o)}},touchFinish:function(t){if(this.hastouchstart)if(this._count<=0)g_oEvent.dispatchEvent(g_tEvent.ELS_PROPGET_BOX,this.touchidx);else{if(0==this.touchidx){var e=t.getLocation(),s=e.x,i=e.y,o=this.node.parent.convertToNodeSpaceAR(cc.v2(s,i));o.y+=this.fingerHeight;var a=!1;if(this.gamelogic){var n=g_wanxArder.game_layer.mapBlocks,c=this.gamelogic.getGridRC(o),r=!1;if(n&&c&&n[c.r]&&n[c.r][c.c]&&(r=255==n[c.r][c.c].getBlockOpacity()),r){for(var l=[],h=-1;h<=1;h++)for(var u=-1;u<=1;u++)c.r+h>=0&&c.r+h<=g_els_localData.maxRow&&c.c+u>=0&&c.c+u<=g_els_localData.maxCol&&l.push({r:c.r+h,c:c.c+u});l.length>0&&(a=!0,this.chuiziDragon&&this.chuiziDragon.playAnimation("eluosi_chuizi"),g_oEvent.dispatchEvent(g_tEvent.ELS_PROP_USED,this.touchidx,l))}}!a&&this.chuizi&&(this.chuizi.setPosition(cc.v2(0,0)),this.chuizi.active=!1),this.syts&&(this.syts.active=!1),g_hx_sdk.report(4)}else if(1==this.touchidx){if(g_elsfk.hasTouch)return;g_hx_sdk.report(3),g_oEvent.dispatchEvent(g_tEvent.ELS_PROP_USED,this.touchidx)}g_elsfk.hasTouch=!1}}}),cc._RF.pop()},{}],els_rank:[function(t,e){"use strict";cc._RF.push(e,"0cec1v7aw1FaIkIAmEeKL0J","els_rank"),cc.Class({extends:cc.Component,properties:{subView:{default:null,type:cc.Node}},start:function(){g_hx_sdk.report(6),g_hx_sdk.postMessage()},onClickClose:function(){this.node.destroy()}}),cc._RF.pop()},{}],els_reviveView:[function(t,e){"use strict";cc._RF.push(e,"26932zJY9hKY6h/0kAmG4oF","els_reviveView"),cc.Class({extends:cc.Component,properties:{m_score:cc.Label,djslab:cc.Label,btnAD:cc.Node,cywj:cc.Label,btnadleft:cc.Label,btnzsDiam:cc.Node,btnzsNum:cc.Node,btnnumLab:cc.Label,btnLab:cc.Label},start:function(){var t=g_arder_gmsc.getelsReviveCDown_els();this._autoClose=!1,this._countdown=5,this._closeRate=0,t&&(this._countdown=t.count,this._autoClose=1==t.auto,this._closeRate=t.crate),this._countdown>0&&(this.djslab.string=this._countdown.toString(),this.schedule(this.upDataTime,1)),this.m_score.string=g_els_localData.getCurTotal(),this.soundM=g_wanxArder.game_layer.soundM,this.cywj,this.changeDiamondBtn(),g_hx_sdk.report(8)},changeDiamondBtn:function(){var t=g_fkwxxx_locData.getItemCountByName("revive");this.btnzsDiam.active=!1,this.btnzsNum.active=!1,t>0?(this.btnLab.string="\u590d\u6d3b",this.btnLab.node.x=0,this.btnzsNum.active=!0,this.btnnumLab.string=t):(this.btnzsDiam.active=!0,this.btnLab.string="\u94bb\u77f3\u590d\u6d3b",this.btnLab.node.x=-24)},upDataTime:function(){this.isPause||(this._countdown--,this._countdown>=0?this.djslab.string=this._countdown.toString():this.djslab.string="0",this._countdown<=0&&(this.unschedule(this.upDataTime),this._autoClose&&this.onBtncloseClick()))},onBtnfhdClick:function(){var t=this;if(this.soundM&&this.soundM.playTouchSound(),g_fkwxxx_locData.getItemCountByName("revive")>0)return g_fkwxxx_locData.changeItemCount("revive",-1),void(this.reviveGame&&this.reviveGame());if(g_fkwxxx_locData.getStars()>=30){if(!g_arder_plat.getNetState())return void Tips.showToast("\u5f53\u524d\u7f51\u7edc\u5dee\uff0c\u91cd\u65b0\u94fe\u63a5\u7f51\u7edc\u8bd5\u8bd5");g_fkwxxx_locData.saveStarCount(-30,"\u94bb\u77f3\u6d88\u8017-\u6d88\u65b9\u5757\u4e2d\u590d\u6d3b"),this.reviveGame&&this.reviveGame()}else this.node.active=!0,g_oEvent.dispatchEvent(g_tEvent.SHOW_SHOP,"game","els_fh",2,function(){g_wanxArder.ComponentIsValid(t)&&t.changeDiamondBtn()})},onBtnfhadClick:function(){var t=this;g_hx_sdk.report(9),this.soundM&&this.soundM.playTouchSound(),g_wxPlat.showVideoAd(function(){g_els_localData.setReviveLeftLife(),t.reviveGame&&t.reviveGame()},function(){})},onBtncloseClick:function(){g_hx_sdk.report(10),this.soundM&&this.soundM.playTouchSound(),g_Tool.getRandom()<this._closeRate&&!g_arder_gmsc.getNotVedio()||this.closeBack&&this.closeBack(!1)}}),cc._RF.pop()},{}],els_settingView:[function(t,e){"use strict";cc._RF.push(e,"74102OLEGVBL54HbZCYDEty","els_settingView"),cc.Class({extends:cc.Component,properties:{tishi:cc.Label,btnSoundImg:cc.Sprite,frame_soundk:cc.SpriteFrame,frame_soundg:cc.SpriteFrame},start:function(){this.soundM=g_wanxArder.game_layer.soundM,this.showSoundBtnState(),g_wxPlat.showInterstitialAd()},setCfg:function(t){t?(this.gamelogic=g_wanxArder.game_layer.gamelogic,this.gamelogic&&this.gamelogic.getSettingCp()&&g_wxPlat.showVideoAd(function(){},function(){})):this.tishi&&(this.tishi.string="\u4e0a\u6b21\u6e38\u620f\u6d88\u9664\u4e86"+g_els_localData.getCurTotal()+"\u5206\uff0c\n \u662f\u5426\u7ee7\u7eed\uff1f")},onBtnJXclick:function(){this.soundM&&this.soundM.playTouchSound(),this.closePanel(),this.continueGame&&this.continueGame()},onBtnRestartClick:function(){g_hx_sdk.report(7),this.soundM&&this.soundM.playTouchSound(),this.closePanel(),this.restartGame&&this.restartGame()},onBtnBackClick:function(){this.soundM&&this.soundM.playTouchSound(),this.closePanel(),this.backLobby&&this.backLobby()},onBtnSoundClick:function(){var t=g_els_localData.getIsSoundClose();g_els_localData.setIsSoundClose(!t),this.showSoundBtnState(),this.playBgSound&&this.playBgSound(!t)},showSoundBtnState:function(){var t=g_els_localData.getIsSoundClose();this.btnSoundImg.spriteFrame=t?this.frame_soundg:this.frame_soundk},closePanel:function(){}}),cc._RF.pop()},{}],els_soundManage:[function(t,e){"use strict";cc._RF.push(e,"033acEaJ/5IfrSsyKIoXAPQ","els_soundManage"),cc.Class({extends:cc.Component,properties:{bgm:cc.Node},start:function(){},playBg:function(){this.bgm&&(this.bgm.active=!1)},pauseBg:function(){this.bgm&&(this.bgm.active=!1)},playStartGameSound:function(){var t=this;g_els_localData.getIsSoundClose()||(this.start_sound?cc.audioEngine.play(this.start_sound,!1,1):g_resLoad.addSound("els_startgame",function(e){t.start_sound=e,cc.audioEngine.play(t.start_sound,!1,1)}))},playOverSound:function(){var t=this;g_els_localData.getIsSoundClose()||(this.over_sound?cc.audioEngine.play(this.over_sound,!1,1):g_resLoad.addSound("els_gameover",function(e){t.over_sound=e,cc.audioEngine.play(t.over_sound,!1,1)}))},playTouchBlockStart:function(){var t=this;g_els_localData.getIsSoundClose()||(this.touchmove_s?cc.audioEngine.play(this.touchmove_s,!1,1):g_resLoad.addSound("els_touchBlockstart",function(e){t.touchmove_s=e,cc.audioEngine.play(t.touchmove_s,!1,1)}))},playTouchBlockEnd:function(){var t=this;g_els_localData.getIsSoundClose()||(this.touchend_sound?cc.audioEngine.play(this.touchend_sound,!1,1):g_resLoad.addSound("els_touchBlockend",function(e){t.touchend_sound=e,cc.audioEngine.play(t.touchend_sound,!1,1)}))},playChuiZiSound:function(){var t=this;g_els_localData.getIsSoundClose()||(this.chuizi_sound?cc.audioEngine.play(this.chuizi_sound,!1,1):g_resLoad.addSound("els_chuizi",function(e){t.chuizi_sound=e,cc.audioEngine.play(t.chuizi_sound,!1,1)}))},playXiaochuSound:function(){var t=this;g_els_localData.getIsSoundClose()||(this.xiaochu_sound?cc.audioEngine.play(this.xiaochu_sound,!1,1):g_resLoad.addSound("els_xiaochu",function(e){t.xiaochu_sound=e,cc.audioEngine.play(t.xiaochu_sound,!1,1)}))},playTouchSound:function(){var t=this;g_els_localData.getIsSoundClose()||(this.touch_sound?cc.audioEngine.play(this.touch_sound,!1,1):g_resLoad.addSound("els_touch",function(e){t.touch_sound=e,cc.audioEngine.play(t.touch_sound,!1,1)}))}}),cc._RF.pop()},{}],els_teach:[function(t,e){"use strict";cc._RF.push(e,"6435bNNGa5Dc7MEYMTK2JRK","els_teach"),cc.Class({extends:cc.Component,properties:{masknode:{default:null,type:cc.Node},shou:{default:null,type:cc.Node},biankuang:cc.Node,bkFrame:[cc.SpriteFrame]},start:function(){this.node.runAction(cc.fadeIn(.3)),g_oEvent.addEventListener(g_tEvent.ELS_TEACH_FINGER,function(t){this.setFingerState(t)}.bind(this))},onDestroy:function(){g_oEvent.clearEventListener(g_tEvent.ELS_TEACH_FINGER,this.setFingerState,this)},setElsMaskGrid:function(t,e,s){if(g_wanxArder.nodeIsValid(this.biankuang)){this.rects=[];var i={x:s.x-50,y:s.y-40,width:100,height:100};this.rects.push(i);var o=2==t?1:0;this.biankuang.getComponent("cc.Sprite").spriteFrame=this.bkFrame[o];for(var a={x:0,y:0},n=0,c=0,r=0;r<e.length;r++){var l=e[r];n+=l.x,c+=l.y}a.x=n/e.length,a.y=c/e.length,this.biankuang.setPosition(a),this.biankuang.rotation=1==t?-90:0,this.setRecWhitStep(t,a),this.setFingerState(!0)}},resetGraphics:function(){var t=this.masknode.getComponent("cc.Mask"),e=t._graphics;e.clear(!1);var s=cc.Mask.Type;if(t._type===s.RECT)for(var i=0;i<this.rects.length;i++){var o=this.rects[i];e.rect(o.x,o.y,o.width,o.height)}cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?e.stroke():e.fill()},setRecWhitStep:function(t,e){var s=[];0==t?s.push({w:697,h:86}):1==t?s.push({w:697,h:137}):(s.push({w:697,h:137}),s.push({w:137,h:697}));for(var i=0;i<s.length;i++){var o=s[i],a={x:-o.w/2,y:e.y-o.h/2,width:o.w,height:o.h};this.rects.push(a)}},setFingerState:function(t){if(this.shou)if(t){this.shou.active=!0,this.shou.stopAllActions(),this.shou.setPosition(cc.v2(80,-380));var e=cc.repeatForever(cc.sequence(cc.scaleTo(.5,.6).easing(cc.easeBackOut()),cc.moveTo(1,cc.v2(0,14)),cc.spawn(cc.scaleTo(.1,1),cc.moveTo(.3,cc.v2(80,-380)))));this.shou.runAction(e),this.resetGraphics()}else this.shou.stopAllActions(),this.shou.active=!1}}),cc._RF.pop()},{}],els_tjdjBox:[function(t,e){"use strict";cc._RF.push(e,"15601GluDZHOYcMm9gS8H7G","els_tjdjBox");var s=["ys_els_tjHammer","ys_els_tjRefresh"];cc.Class({extends:cc.Component,properties:{tssm:cc.Label,daojutu:cc.Sprite,frame_dj:[cc.SpriteFrame]},setCfg:function(t){this.tssm.string=0==t?"\u5feb\u53bb\u4f7f\u7528\u201c\u9524\u5b50\u201d\u9053\u5177\u5427":"\u5feb\u53bb\u4f7f\u7528\u201c\u6362\u4e00\u6362\u201d\u9053\u5177\u5427",this.daojutu.spriteFrame=this.frame_dj[t],this._ysname=s[t],this.addYsAd()},onbtnUseClick:function(){this.usedBack&&this.usedBack(),this.removeYsAd()},onbtnCloseClick:function(){this.closeBack&&this.closeBack(),this.removeYsAd()},addYsAd:function(){},removeYsAd:function(){}}),cc._RF.pop()},{}]},{},["els_blockGroup","els_blockgrid","els_gameLayer","els_gameLogic","els_groupBoom","els_mapblock","els_localData","els_propTouch","els_soundManage","els_gameReviveBegin","els_gameover","els_propBox","els_rank","els_reviveView","els_settingView","els_teach","els_tjdjBox"]);